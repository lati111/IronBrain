import{g as S}from"./ajax-3bdbf024.js";import{t as d,a as b}from"./utilities-90bfc28c.js";import{o as y,c as L}from"./modal-4a070ce7.js";import"./index-1bf8d157.js";let v,n,p,i;async function h(l,t,r){v=l,p=new URL(r),n=document.querySelector("#"+t);const e=n.querySelector('select[name="filter-select"]'),a=n.querySelectorAll('select:not(select[name="filter-select"]),input');for(const s of a)s.classList.add("hidden");e.removeEventListener("change",f,!0),e.addEventListener("change",f,!0),y(t);const o=await S(p.toString());e.innerHTML='<option class="placeholder hidden">Choose filter</option>';for(const s of o){const c=document.createElement("option");c.textContent=d(s),c.value=s,e.append(c)}}function q(){if(n===null||i===null)return;const t=n.querySelector('select[name="filter-select"]').value;let r="",e="",a="";switch(i){case"number":case"date":case"select":const c=n.querySelector('select[name="operator-select"]');r=c.children[c.selectedIndex].textContent,e=c.value;break;case"bool":const u=n.querySelector('select[name="bool-select"]');r=u.children[u.selectedIndex].textContent,e=u.value}switch(i){case"number":a=n.querySelector('input[name="number-input"]').value;break;case"date":a=n.querySelector('input[name="date-input"]').value;break;case"select":a=n.querySelector('select[name="value-select"]').value;break}const s=document.querySelector("#"+v+"-filterlist").querySelector(".filter-container");s.querySelector(`div[data-filter="${t}"][data-operator="${e}"][data-value="${a}"]`)!==null&&b("Filter already exists"),s.prepend(x(i,t,e,r,a)),L()}function x(l,t,r,e,a){const o=document.createElement("div");switch(o.classList.add("filter"),o.classList.add("px-2"),o.classList.add("py-1"),o.classList.add("red-underlined"),o.classList.add("flex"),o.setAttribute("data-filter",t),o.setAttribute("data-operator",r),o.setAttribute("data-value",a),l){case"number":case"date":case"select":o.innerHTML=`<span>${d(t)} ${e} ${a}</span>`;break;case"bool":o.innerHTML=`<span>${e} ${d(t)}</span>`}return o.innerHTML+=`<button type="button" class="pl-1.5 ml-auto" onclick="this.closest('.filter').remove()">
            <img src="/img/icons/x.svg" alt="close" class="interactive w-5 h-5">
        </button>`,o}async function f(){if(n===null||p===null)return;const l=n.querySelector('select[name="filter-select"]'),t=n.querySelectorAll('select:not(select[name="filter-select"]),input');for(const a of t)a.classList.add("hidden");const r=p;r.searchParams.append("filter",l.value);const e=await S(r.toString());switch(i=e.type,e.type){case"select":m(e.operators),w(e.options);break;case"number":m(e.operators),g(e.options);break;case"date":m(e.operators),k(e.options);break;case"bool":E(e.operators);break}}function m(l){if(n===null)return;const t=n.querySelector('select[name="operator-select"]');t.classList.remove("hidden"),t.innerHTML="";for(const r of l){const e=document.createElement("option");e.textContent=r.text,e.value=r.operator,t.append(e)}}function w(l){if(n===null)return;const t=n.querySelector('select[name="value-select"]');t.classList.remove("hidden"),t.innerHTML="";for(const r of l){const e=document.createElement("option");e.textContent=d(r),e.value=r,t.append(e)}}function g(l){if(n===null)return;const t=n.querySelector('input[name="number-input"]');t.classList.remove("hidden"),t.min=l.min,t.max=l.max,t.value=l.min}function k(l){if(n===null)return;const t=n.querySelector('input[name="date-input"]');t.classList.remove("hidden"),t.min=l.min,t.max=l.max,t.value=l.min}function E(l){if(n===null)return;const t=n.querySelector('select[name="bool-select"]');t.classList.remove("hidden"),t.innerHTML="";for(const r of l){const e=document.createElement("option");e.textContent=r.text,e.value=r.operator,t.append(e)}}window.openFilterlist=h;window.addFilter=q;
